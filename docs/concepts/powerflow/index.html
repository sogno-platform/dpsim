<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.108.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/dpsim/favicons/favicon.ico><link rel=apple-touch-icon href=/dpsim/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/dpsim/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/dpsim/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/dpsim/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/dpsim/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/dpsim/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/dpsim/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/dpsim/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/dpsim/favicons/android-192x192.png sizes=192x192><title>Powerflow | DPsim</title><meta name=description content="The power flow problem is about the calculation of voltage magnitudes and angles for one set of buses. The solution is obtained from a given set of voltage magnitudes and power levels for a specific model of the network configuration. The power flow solution exhibits the voltages and angles at all buses and real and reactive flows can be deduced from the same.
Power System Model Power systems are modeled as a network of buses (nodes) and branches (lines)."><meta property="og:title" content="Powerflow"><meta property="og:description" content="The power flow problem is about the calculation of voltage magnitudes and angles for one set of buses. The solution is obtained from a given set of voltage magnitudes and power levels for a specific model of the network configuration. The power flow solution exhibits the voltages and angles at all buses and real and reactive flows can be deduced from the same.
Power System Model Power systems are modeled as a network of buses (nodes) and branches (lines)."><meta property="og:type" content="article"><meta property="og:url" content="https://sogno-platform.github.io/dpsim/docs/concepts/powerflow/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2020-03-18T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-19T09:13:55+02:00"><meta property="og:site_name" content="DPsim"><meta itemprop=name content="Powerflow"><meta itemprop=description content="The power flow problem is about the calculation of voltage magnitudes and angles for one set of buses. The solution is obtained from a given set of voltage magnitudes and power levels for a specific model of the network configuration. The power flow solution exhibits the voltages and angles at all buses and real and reactive flows can be deduced from the same.
Power System Model Power systems are modeled as a network of buses (nodes) and branches (lines)."><meta itemprop=datePublished content="2020-03-18T00:00:00+00:00"><meta itemprop=dateModified content="2025-05-19T09:13:55+02:00"><meta itemprop=wordCount content="1620"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Powerflow"><meta name=twitter:description content="The power flow problem is about the calculation of voltage magnitudes and angles for one set of buses. The solution is obtained from a given set of voltage magnitudes and power levels for a specific model of the network configuration. The power flow solution exhibits the voltages and angles at all buses and real and reactive flows can be deduced from the same.
Power System Model Power systems are modeled as a network of buses (nodes) and branches (lines)."><link rel=preload href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css as=style><link href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/dpsim/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>DPsim</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/dpsim/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocs-li><a href=/dpsim/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-dpsimdocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsoverview-li><a href=/dpsim/docs/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsoverview><span>Overview</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewarchitecture-li><a href=/dpsim/docs/overview/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewarchitecture><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewattributes-li><a href=/dpsim/docs/overview/attributes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewattributes><span>Attributes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewscheduling-li><a href=/dpsim/docs/overview/scheduling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewscheduling><span>Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewinterfaces-li><a href=/dpsim/docs/overview/interfaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewinterfaces><span>Interfaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewmnainterface-li><a href=/dpsim/docs/overview/mnainterface/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewmnainterface><span>Interfacing with the MNA Solver</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewsubcomponents-li><a href=/dpsim/docs/overview/subcomponents/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewsubcomponents><span>Subcomponent Handling</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsgetting-started-li><a href=/dpsim/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsgetting-started><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedreal-time-li><a href=/dpsim/docs/getting-started/real-time/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedreal-time><span>Real-Time</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedbuild-li><a href=/dpsim/docs/getting-started/build/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedbuild><span>Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedinstall-li><a href=/dpsim/docs/getting-started/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedinstall><span>Install</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocsconcepts-li><a href=/dpsim/docs/concepts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsconcepts><span>Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsdyn-phasors-li><a href=/dpsim/docs/concepts/dyn-phasors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsdyn-phasors><span>Dynamic Phasors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsnodal-analysis-li><a href=/dpsim/docs/concepts/nodal-analysis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsnodal-analysis><span>Nodal Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-dpsimdocsconceptspowerflow-li><a href=/dpsim/docs/concepts/powerflow/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptspowerflow><span class=td-sidebar-nav-active-item>Powerflow</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsdevelopment-li><a href=/dpsim/docs/development/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsdevelopment><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentdebugging-li><a href=/dpsim/docs/development/debugging/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentdebugging><span>Debugging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentguidelines-li><a href=/dpsim/docs/development/guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentguidelines><span>Guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsmodels-li><a href=/dpsim/docs/models/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsmodels><span>Models</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelstransformer-li><a href=/dpsim/docs/models/transformer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelstransformer><span>Transformer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsbranches-li><a href=/dpsim/docs/models/branches/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsbranches><span>Branches</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsinduction-machine-li><a href=/dpsim/docs/models/induction-machine/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsinduction-machine><span>Induction Machine</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsrlc-elements-li><a href=/dpsim/docs/models/rlc-elements/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsrlc-elements><span>RLC-Elements</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelssynchronous-generator-li><a href=/dpsim/docs/models/synchronous-generator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelssynchronous-generator><span>Synchronous Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelspower-electronics-li><a href=/dpsim/docs/models/power-electronics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelspower-electronics><span>VS-Inverter</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocstasks-li><a href=/dpsim/docs/tasks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocstasks><span>Core Tasks</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstasksadd-model-li><a href=/dpsim/docs/tasks/add-model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstasksadd-model><span>Add New Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstaskscreate-simulation-li><a href=/dpsim/docs/tasks/create-simulation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstaskscreate-simulation><span>Create New Simulation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsexamples-li><a href=/dpsim/docs/examples/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsexamples><span>Examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsroadmap-li><a href=/dpsim/docs/roadmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsroadmap><span>Roadmap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsreference-li><a href=/dpsim/docs/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsreference><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocscontribution-guidelines-li><a href=/dpsim/docs/contribution-guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocscontribution-guidelines><span>Contribution Guidelines</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/sogno-platform/dpsim/tree/master/content/en/docs/Concepts/powerflow.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/sogno-platform/dpsim/edit/master/content/en/docs/Concepts/powerflow.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/sogno-platform/dpsim/new/master/content/en/docs/Concepts/powerflow.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/sogno-platform/dpsim/issues/new?title=Powerflow" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/sogno-platform/dpsim/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=https://sogno-platform.github.io/dpsim/docs/concepts/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#powerflow-problem-with-power-mismatch-function-and-polar-coordinates>Powerflow Problem with Power Mismatch Function and Polar Coordinates</a><ul><li><a href=#formulation-of-mismatch-function>Formulation of Mismatch Function</a></li><li><a href=#formulation-of-jacobian>Formulation of Jacobian</a></li></ul></li><li><a href=#solution-of-the-problem>Solution of the Problem</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/concepts/>Concepts</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://sogno-platform.github.io/dpsim/docs/concepts/powerflow/ aria-disabled=true class="btn-link disabled">Powerflow</a></li></ol></nav><div class=td-content><h1>Powerflow</h1><header class=article-meta></header><p>The power flow problem is about the calculation of voltage magnitudes and angles for one set of buses.
The solution is obtained from a given set of voltage magnitudes and power levels for a specific model of the network configuration.
The power flow solution exhibits the voltages and angles at all buses and real and reactive flows can be deduced from the same.</p><h1 id=power-system-model>Power System Model</h1><p>Power systems are modeled as a network of buses (nodes) and branches (lines).
To a network bus, components such a generator, load, and transmission substation can be connected.
Each bus in the network is fully described by the following four electrical quantities:</p><ul><li>$\vert V_{k} \vert$: the voltage magnitude</li><li>$\theta_{k}$: the voltage phase angle</li><li>$P_{k}$: the active power</li><li>$Q_{k}$: the reactive power</li></ul><p>There are three types of networks buses: VD bus, PV bus and PQ bus.
Depending on the type of the bus, two of the four electrical quantities are specified as shown in the table below.</p><table><thead><tr><th>Bus Type</th><th>Known</th><th>Unknown</th></tr></thead><tbody><tr><td>$VD$</td><td>$\vert V_{k} \vert, \theta_{k}$</td><td>$P_{k}, Q_{k}$</td></tr><tr><td>$PV$</td><td>$P_{k}, \vert V_{k} \vert$</td><td>$Q_{k}, \theta_{k}$</td></tr><tr><td>$PQ$</td><td>$P_{k}, Q_{k}$</td><td>$\vert V_{k} \vert, \theta_{k}$</td></tr></tbody></table><h1 id=single-phase-power-flow-problem>Single Phase Power Flow Problem</h1><p>The power flow problem can be expressed by the goal to bring a mismatch function $\vec{f}$ to zero.
The value of the mismatch function depends on a solution vector $\vec{x}$:</p><div class=math>$$\vec{f}(\vec{x}) = 0$$</div><p>As $\vec{f}(\vec{x})$ will be nonlinear, the equation system will be solved with Newton-Raphson:</p><div class=math>$$-\textbf{J}(\vec{x}) \Delta \vec{x} = \vec{f} (\vec{x})$$</div><p>where $\Delta \vec{x}$ is the correction of the solution vector and $\textbf{J}(\vec{x})$ is the Jacobian matrix.
The solution vector $\vec{x}$ represents the voltage $\vec{V}$ by polar or cartesian quantities.
The mismatch function $\vec{f}$ will either represent the power mismatch $\Delta \vec{S}$ in terms of</p><div class=math>$$\left [ \begin{array}{c} \Delta \vec{P} \\ \Delta \vec{Q} \end{array} \right ]$$</div><p>or the current mismatch $\Delta \vec{I}$ in terms of</p><div class=math>$$\left [ \begin{array}{c} \Delta \vec{I_{real}} \\ \Delta \vec{I_{imag}} \end{array} \right ]$$</div><p>where the vectors split the complex quantities into real and imaginary parts.
Futhermore, the solution vector $\vec{x}$ will represent $\vec{V}$ either by polar coordinates</p><div class=math>$$\left [ \begin{array}{c} \vec{\delta} \\ \vert \vec{V} \vert \end{array} \right ]$$</div><p>or rectangular coordinates</p><div class=math>$$\left [ \begin{array}{c} \vec{V_{real}} \\ \vec{V_{imag}} \end{array} \right ]$$</div><p>This results in four different formulations of the powerflow problem:</p><ul><li>with power mismatch function and polar coordinates</li><li>with power mismatch function and rectangular coordinates</li><li>with current mismatch function and polar coordinates</li><li>with current mismatch function and rectangular coordinates</li></ul><p>To solve the problem using NR, we need to formulate $\textbf{J} (\vec{x})$ and $\vec{f} (\vec{x})$ for each powerflow problem formulation.</p><h2 id=powerflow-problem-with-power-mismatch-function-and-polar-coordinates>Powerflow Problem with Power Mismatch Function and Polar Coordinates</h2><h3 id=formulation-of-mismatch-function>Formulation of Mismatch Function</h3><p>The injected power at a node $k$ is given by:</p><div class=math>$$S_{k} = V_{k} I _{k}^{*}$$</div><p>The current injection into any bus $k$ may be expressed as:</p><div class=math>$$I_{k} = \sum_{j=1}^{N} Y_{kj} V_{j}$$</div><p>Substitution yields:</p><div class=math>$$\begin{align}
S_{k} &= V_{k} \left ( \sum_{j=1}^{N} Y_{kj} V_{j} \right )^{*} \nonumber \\
&= V_{k} \sum_{j=1}^{N} Y_{kj}^{*} V_{j} ^{*} \nonumber
\end{align}$$</div><p>We may define $G_{kj}$ and $B_{kj}$ as the real and imaginary parts of the admittance matrix element $Y_{kj}$ respectively, so that $Y_{kj} = G_{kj} + jB_{kj}$.
Then we may rewrite the last equation:</p><div class=math>$$\begin{align}
S_{k} &= V_{k} \sum_{j=1}^{N} Y_{kj}^{*} V_{j}^{*} \nonumber \\
&= \vert V_{k} \vert \angle \theta_{k} \sum_{j=1}^{N} (G_{kj} + jB_{kj})^{*} ( \vert V_{j} \vert \angle \theta_{j})^{*} \nonumber \\
&= \vert V_{k} \vert \angle \theta_{k} \sum_{j=1}^{N} (G_{kj} - jB_{kj}) ( \vert V_{j} \vert \angle - \theta_{j}) \nonumber \\
&= \sum_{j=1} ^{N} \vert V_{k} \vert \angle \theta_{k} ( \vert V_{j} \vert \angle - \theta_{j}) (G_{kj} - jB_{kj}) \nonumber \\
&= \sum_{j=1} ^{N} \left ( \vert V_{k} \vert \vert V_{j} \vert \angle (\theta_{k} - \theta_{j}) \right ) (G_{kj} - jB_{kj}) \nonumber \\
&= \sum_{j=1} ^{N} \vert V_{k} \vert \vert V_{j} \vert \left ( cos(\theta_{k} - \theta_{j}) + jsin(\theta_{k} - \theta_{j}) \right ) (G_{kj} - jB_{kj})
\end{align}$$</div><p>If we now perform the algebraic multiplication of the two terms inside the parentheses, and collect real and imaginary parts, and recall that $S_{k} = P_{k} + jQ_{k}$, we can express (1) as two equations: one for the real part, $P_{k}$, and one for the imaginary part, $Q_{k}$, according to:</p><div class=math>$$\begin{align}
{P}_{k} = \sum_{j=1}^{N} \vert V_{k} \vert \vert V_{j} \vert \left ( G_{kj}cos(\theta_{k} - \theta_{j}) + B_{kj} sin(\theta_{k} - \theta_{j}) \right ) \\
{Q}_{k} = \sum_{j=1}^{N} \vert V_{k} \vert \vert V_{j} \vert \left ( G_{kj}sin(\theta_{k} - \theta_{j}) - B_{kj} cos(\theta_{k} - \theta_{j}) \right )
\end{align}$$</div><p>These equations are called the power flow equations, and they form the fundamental building block from which we solve the power flow problem.</p><p>We consider a power system network having $N$ buses. We assume one VD bus, $N_{PV}-1$ PV buses and $N-N_{PV}$ PQ buses.
We assume that the VD bus is numbered bus $1$, the PV buses are numbered $2,&mldr;,N_{PV}$, and the PQ buses are numbered $N_{PV}+1,&mldr;,N$.
We define the vector of unknown as the composite vector of unknown angles $\vec{\theta}$ and voltage magnitudes $\vert \vec{V} \vert$:</p><div class=math>$$\begin{align}
\vec{x} = \left[ \begin{array}{c} \vec{\theta} \\ \vert \vec{V} \vert \\ \end{array} \right ]
= \left[ \begin{array}{c} \theta_{2} \\ \theta_{3} \\ \vdots \\ \theta_{N} \\ \vert V_{N_{PV+1}} \vert \\ \vert V_{N_{PV+2}} \vert \\ \vdots \\ \vert V_{N} \vert \end{array} \right]
\end{align}$$</div><p>The right-hand sides of equations (2) and (3) depend on the elements of the unknown vector $\vec{x}$.
Expressing this dependency more explicitly, we rewrite these equations as:</p><div class=math>$$\begin{align}
P_{k} = P_{k} (\vec{x}) \Rightarrow P_{k}(\vec{x}) - P_{k} &= 0 \quad \quad k = 2,...,N \\
Q_{k} = Q_{k} (\vec{x}) \Rightarrow Q_{k} (\vec{x}) - Q_{k} &= 0 \quad \quad k = N_{PV}+1,...,N
\end{align}$$</div><p>We now define the mismatch vector $\vec{f} (\vec{x})$ as:</p><div class=math>$$\begin{align}
\vec{f} (\vec{x}) = \left [ \begin{array}{c} f_{1}(\vec{x}) \\ \vdots \\ f_{N-1}(\vec{x}) \\ ------ \\ f_{N}(\vec{x}) \\ \vdots \\ f_{2N-N_{PV} -1}(\vec{x}) \end{array} \right ]
= \left [ \begin{array}{c} P_{2}(\vec{x}) - P_{2} \\ \vdots \\ P_{N}(\vec{x}) - P_{N} \\ --------- \\ Q_{N_{PV}+1}(\vec{x}) - Q_{N_{PV}+1} \\ \vdots \\ Q_{N}(\vec{x}) - Q_{N} \end{array} \right]
= \left [ \begin{array}{c} \Delta P_{2} \\ \vdots \\ \Delta P_{N} \\ ------ \\ \Delta Q_{N_{PV}+1} \\ \vdots \\ \Delta Q_{N} \end{array} \right ]
= \vec{0}
\end{align}$$</div><p>That is a system of nonlinear equations.
This nonlinearity comes from the fact that $P_{k}$ and $Q_{k}$ have terms containing products of some of the unknowns and also terms containing trigonometric functions of some the unknowns.</p><h3 id=formulation-of-jacobian>Formulation of Jacobian</h3><p>As discussed in the previous section, the power flow problem will be solved using the Newton-Raphson method. Here, the Jacobian matrix is obtained by taking all first-order partial derivates of the power mismatch functions with respect to the voltage angles $\theta_{k}$ and magnitudes $\vert V_{k} \vert$ as:</p><div class=math>$$\begin{align}
J_{jk}^{P \theta} &= \frac{\partial P_{j} (\vec{x} ) } {\partial \theta_{k}} = \vert V_{j} \vert \vert V_{k} \vert \left ( G_{jk} sin(\theta_{j} - \theta_{k}) - B_{jk} cos(\theta_{j} - \theta_{k} ) \right ) \\
J_{jj}^{P \theta} &= \frac{\partial P_{j}(\vec{x})}{\partial \theta_{j}} = -Q_{j} (\vec{x} ) - B_{jj} \vert V_{j} \vert ^{2} \\
J_{jk}^{Q \theta} &= \frac{\partial Q_{j}(\vec{x})}{\partial \theta_{k}} = - \vert V_{j} \vert \vert V_{k} \vert \left ( G_{jk} cos(\theta_{j} - \theta_{k}) + B_{jk} sin(\theta_{j} - \theta_{k}) \right ) \\
J_{jj}^{Q \theta} &= \frac{\partial Q_{j}(\vec{x})}{\partial \theta_{k}} = P_{j} (\vec{x} ) - G_{jj} \vert V_{j} \vert ^{2} \\
J_{jk}^{PV} &= \frac{\partial P_{j} (\vec{x} ) } {\partial \vert V_{k} \vert } = \vert V_{j} \vert \left ( G_{jk} cos(\theta_{j} - \theta_{k}) + B_{jk} sin(\theta_{j} - \theta_{k}) \right ) \\
J_{jj}^{PV} &= \frac{\partial P_{j}(\vec{x})}{\partial \vert V_{j} \vert } = \frac{P_{j} (\vec{x} )}{\vert V_{j} \vert} + G_{jj} \vert V_{j} \vert \\
J_{jk}^{QV} &= \frac{\partial Q_{j} (\vec{x} ) } {\partial \vert V_{k} \vert } = \vert V_{j} \vert \left ( G_{jk} sin(\theta_{j} - \theta_{k}) + B_{jk} cos(\theta_{j} - \theta_{k}) \right ) \\
J_{jj}^{QV} &= \frac{\partial Q_{j}(\vec{x})}{\partial \vert V_{j} \vert } = \frac{Q_{j} (\vec{x} )}{\vert V_{j} \vert} - B_{jj} \vert V_{j} \vert \\
\end{align}$$</div><p>The linear system of equations that is solved in every Newton iteration can be written in matrix form as follows:</p><div class=math>$$\begin{align}
-\left [ \begin{array}{cccccc}
\frac{\partial \Delta P_{2} }{\partial \theta_{2}} & \cdots & \frac{\partial \Delta P_{2} }{\partial \theta_{N}} &
    \frac{\partial \Delta P_{2} }{\partial \vert V_{N_{G+1}} \vert} & \cdots & \frac{\partial \Delta P_{2} }{\partial \vert V_{N} \vert} \\
\vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    \frac{\partial \Delta P_{N} }{\partial \theta_{2}} & \cdots & \frac{\partial \Delta P_{N}}{\partial \theta_{N}} &
    \frac{\partial \Delta P_{N}}{\partial \vert V_{N_{G+1}} \vert } & \cdots & \frac{\partial \Delta P_{N}}{\partial \vert V_{N} \vert} \\
\frac{\partial \Delta Q_{N_{G+1}} }{\partial \theta_{2}} & \cdots & \frac{\partial \Delta Q_{N_{G+1}} }{\partial \theta_{N}} &
    \frac{\partial \Delta Q_{N_{G+1}} }{\partial \vert V_{N_{G+1}} \vert } & \cdots & \frac{\partial \Delta Q_{N_{G+1}} }{\partial \vert V_{N} \vert} \\
\vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
    \frac{\partial \Delta Q_{N}}{\partial \theta_{2}} & \cdots & \frac{\partial \Delta Q_{N}}{\partial \theta_{N}} &
    \frac{\partial \Delta Q_{N}}{\partial \vert V_{N_{G+1}} \vert } & \cdots & \frac{\partial \Delta Q_{N}}{\partial \vert V_{N} \vert}
\end{array} \right ]
\left [ \begin{array}{c} \Delta \theta_{2} \\ \vdots \\ \Delta \theta_{N} \\ \Delta \vert V_{N_{G+1}} \vert \\ \vdots \\ \Delta \vert V_{N} \vert \end{array} \right ]
= \left [ \begin{array}{c} \Delta P_{2} \\ \vdots \\ \Delta P_{N} \\ \Delta Q_{N_{G+1}} \\ \vdots \\ \Delta Q_{N} \end{array} \right ]
\end{align}$$</div><h2 id=solution-of-the-problem>Solution of the Problem</h2><p>The solution update formula is given by:</p><div class=math>$$\begin{align}
\vec{x}^{(i+1)} = \vec{x}^{(i)} + \Delta \vec{x}^{(i)} = \vec{x}^{(i)} - \textbf{J}^{-1} \vec{f} (\vec{x}^{(i)})
\end{align}$$</div><p>To sum up, the NR algorithm, for application to the power flow problem is:</p><ol><li>Set the iteration counter to $i=1$. Use the initial solution $V_{i} = 1 \angle 0^{\circ}$</li><li>Compute the mismatch vector $\vec{f}({\vec{x}})$ using the power flow equations</li><li>Perform the following stopping criterion tests:<ul><li>If $\vert \Delta P_{i} \vert &lt; \epsilon_{P}$ for all type PQ and PV buses and</li><li>If $\vert \Delta Q_{i} \vert &lt; \epsilon_{Q}$ for all type PQ</li><li>Then go to step 6</li><li>Otherwise, go to step 4.</li></ul></li><li>Evaluate the Jacobian matrix $\textbf{J}^{(i)}$ and compute $\Delta \vec{x}^{(i)}$.</li><li>Compute the update solution vector $\vec{x}^{(i+1)}$. Return to step 3.</li><li>Stop.</li></ol><div class="text-muted mt-5 pt-3 border-top">Last modified 19.05.2025: <a href=https://github.com/sogno-platform/dpsim/commit/3136b5a477415979041576120b0f27c17050a6f4>pybind: Errors when compiling with clang (#334) (3136b5a)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://slack.lfenergy.org/ aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="GitHub Discussions" aria-label="GitHub Discussions"><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim/discussions aria-label="GitHub Discussions"><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="RWTH GitLab" aria-label="RWTH GitLab"><a class=text-white target=_blank rel=noopener href=https://git.rwth-aachen.de/acs/public/simulation/dpsim/dpsim aria-label="RWTH GitLab"><i class="fab fa-gitlab"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The DPsim Authors All Rights Reserved</small></div></div></div></footer></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ==" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\]"}]})'></script><script src=/dpsim/js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" crossorigin=anonymous></script>
<script src=/dpsim/js/tabpane-persist.js></script></body></html>