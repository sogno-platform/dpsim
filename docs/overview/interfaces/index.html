<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.108.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/dpsim/favicons/favicon.ico><link rel=apple-touch-icon href=/dpsim/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/dpsim/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/dpsim/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/dpsim/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/dpsim/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/dpsim/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/dpsim/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/dpsim/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/dpsim/favicons/android-192x192.png sizes=192x192><title>Interfaces | DPsim</title><meta name=description content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component."><meta property="og:title" content="Interfaces"><meta property="og:description" content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component."><meta property="og:type" content="article"><meta property="og:url" content="https://sogno-platform.github.io/dpsim/docs/overview/interfaces/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2025-02-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-19T09:13:55+02:00"><meta property="og:site_name" content="DPsim"><meta itemprop=name content="Interfaces"><meta itemprop=description content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component."><meta itemprop=datePublished content="2025-02-13T00:00:00+00:00"><meta itemprop=dateModified content="2025-05-19T09:13:55+02:00"><meta itemprop=wordCount content="1113"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Interfaces"><meta name=twitter:description content="Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA. Simulation signals in the form of Attributes can be imported or exported once per simulation time step. Interfaces are subclasses of Interface and implement the methods addExport and addImport, which add dependencies to the passed attribute that forward the attribute value from or to the interface. This way, attributes that are imported are read from the interface before they are used in any DPsim component."><link rel=preload href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css as=style><link href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/dpsim/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>DPsim</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/dpsim/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocs-li><a href=/dpsim/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-dpsimdocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocsoverview-li><a href=/dpsim/docs/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsoverview><span>Overview</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewarchitecture-li><a href=/dpsim/docs/overview/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewarchitecture><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewattributes-li><a href=/dpsim/docs/overview/attributes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewattributes><span>Attributes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewscheduling-li><a href=/dpsim/docs/overview/scheduling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewscheduling><span>Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-dpsimdocsoverviewinterfaces-li><a href=/dpsim/docs/overview/interfaces/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewinterfaces><span class=td-sidebar-nav-active-item>Interfaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewmnainterface-li><a href=/dpsim/docs/overview/mnainterface/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewmnainterface><span>Interfacing with the MNA Solver</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewsubcomponents-li><a href=/dpsim/docs/overview/subcomponents/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewsubcomponents><span>Subcomponent Handling</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsgetting-started-li><a href=/dpsim/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsgetting-started><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedreal-time-li><a href=/dpsim/docs/getting-started/real-time/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedreal-time><span>Real-Time</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedbuild-li><a href=/dpsim/docs/getting-started/build/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedbuild><span>Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedinstall-li><a href=/dpsim/docs/getting-started/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedinstall><span>Install</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsconcepts-li><a href=/dpsim/docs/concepts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsconcepts><span>Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsdyn-phasors-li><a href=/dpsim/docs/concepts/dyn-phasors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsdyn-phasors><span>Dynamic Phasors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsnodal-analysis-li><a href=/dpsim/docs/concepts/nodal-analysis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsnodal-analysis><span>Nodal Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptspowerflow-li><a href=/dpsim/docs/concepts/powerflow/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptspowerflow><span>Powerflow</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsdevelopment-li><a href=/dpsim/docs/development/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsdevelopment><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentdebugging-li><a href=/dpsim/docs/development/debugging/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentdebugging><span>Debugging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentguidelines-li><a href=/dpsim/docs/development/guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentguidelines><span>Guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsmodels-li><a href=/dpsim/docs/models/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsmodels><span>Models</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelstransformer-li><a href=/dpsim/docs/models/transformer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelstransformer><span>Transformer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsbranches-li><a href=/dpsim/docs/models/branches/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsbranches><span>Branches</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsinduction-machine-li><a href=/dpsim/docs/models/induction-machine/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsinduction-machine><span>Induction Machine</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsrlc-elements-li><a href=/dpsim/docs/models/rlc-elements/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsrlc-elements><span>RLC-Elements</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelssynchronous-generator-li><a href=/dpsim/docs/models/synchronous-generator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelssynchronous-generator><span>Synchronous Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelspower-electronics-li><a href=/dpsim/docs/models/power-electronics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelspower-electronics><span>VS-Inverter</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocstasks-li><a href=/dpsim/docs/tasks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocstasks><span>Core Tasks</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstasksadd-model-li><a href=/dpsim/docs/tasks/add-model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstasksadd-model><span>Add New Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstaskscreate-simulation-li><a href=/dpsim/docs/tasks/create-simulation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstaskscreate-simulation><span>Create New Simulation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsexamples-li><a href=/dpsim/docs/examples/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsexamples><span>Examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsroadmap-li><a href=/dpsim/docs/roadmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsroadmap><span>Roadmap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsreference-li><a href=/dpsim/docs/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsreference><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocscontribution-guidelines-li><a href=/dpsim/docs/contribution-guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocscontribution-guidelines><span>Contribution Guidelines</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/sogno-platform/dpsim/tree/master/content/en/docs/Overview/interfaces.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/sogno-platform/dpsim/edit/master/content/en/docs/Overview/interfaces.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/sogno-platform/dpsim/new/master/content/en/docs/Overview/interfaces.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/sogno-platform/dpsim/issues/new?title=Interfaces" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/sogno-platform/dpsim/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=https://sogno-platform.github.io/dpsim/docs/overview/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/overview/>Overview</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://sogno-platform.github.io/dpsim/docs/overview/interfaces/ aria-disabled=true class="btn-link disabled">Interfaces</a></li></ol></nav><div class=td-content><h1>Interfaces</h1><header class=article-meta></header><p>Interfaces can be used to exchange simulation signals between a DPsim simulation and other soft- or hardware, for example an MQTT-broker or an FPGA.
Simulation signals in the form of <a href=https://sogno-platform.github.io/dpsim/docs/overview/attributes/>Attributes</a> can be <strong>imported</strong> or <strong>exported</strong> once per simulation time step.
Interfaces are subclasses of <code>Interface</code> and implement the methods <code>addExport</code> and <code>addImport</code>, which add dependencies to the passed attribute that forward the attribute value from or to the interface.
This way, attributes that are imported are read from the interface before they are used in any DPsim component.
Attributes that are exported are written to the interface after they are set by a DPsim component.</p><h1 id=interfacing-with-villasnode>Interfacing with VILLASnode</h1><blockquote><p>This feature requires the compilation of DPsim with the <code>WITH_VILLAS</code> feature flag. For use of the VILLASnode interface in python, the <code>dpsimpyvillas</code> target has to built in addition to the normal <code>dpsimpy</code> package.</p></blockquote><p>The VILLASnode interface is designed to make use of the various node types and protocols supported by the <a href=https://github.com/VILLASframework/node>VILLASframework</a>.
By utilizing the nodes provided by VILLASnode, it can be configured to import and export attributes using a wide range of protocols.
There are two interface implementations for VILLASnode: <code>InterfaceVillasQueued</code> and <code>InterfaceVillasQueueless</code>.
<code>InterfaceVillasQueued</code> uses a ring buffer to store signal data between DPsim and VILLASnode to allow the protocol used in VILLASnode to operate at a different rate and non-synchronized to the DPsim time step.
<code>InterfaceVillasQueueless</code> uses direct communication with a VILLASnode node type implementing a specific protocol without using a buffer, thus enabling significantly lower latency communication.
With <code>InterfaceVillasQueueless</code>, the protocol operates at the time step of DPsim, i.e., an attribute update directly triggers a <code>write()</code> call to the connected VILLASnode node type.
<code>InterfaceVillasQueued</code> should be used when using non- or soft real-time protocols or communication mediums, such as MQTT or connections via the internet.
<code>InterfaceVillasQueueless</code> should be used when communicating using reliable, low latency, real-time protocols, e.g., with FPGAs, via dedicated fibre networks, or with local real-time applications.</p><p>To create and configure one of the VILLASnode interface instance, create a new shared pointer of type <code>InterfaceVillasQueued</code> or <code>InterfaceVillasQueueless</code> and supply it with a configuration string in the first constructor argument.
This configuration must be a valid JSON object containing the settings for the VILLASnode node type that should be used for data import and export.
This means that the JSON contains a <code>type</code> key describing what node type to use, as well as any additional configuration options required for this node type.
The valid configuration keys can be found in the <a href=https://villas.fein-aachen.org/doc/node-node-types.html>VILLASnode documentation</a>.</p><blockquote><p>Note for <code>InterfaceVillasQueueless</code>:
The queueless interface expects the first input signal in the VILLASnode configuration to be a sequence number that is incremented every time step.
If the value of the sequence number is not incremented by one between two consecutive time steps, an overrun is detected.
Because logging outputs can cause large delays and overruns should not occur spuriously, the interface only reports a warning when a large number of overruns occur.</p></blockquote><p>After the object is created, the <code>exportAttribute</code> and <code>importAttribute</code> methods can be used to set up the data exchange between the DPsim simulation and the configured node.
The attributes given as the first parameter to these methods are attributes belonging to components in the simulation which should be read or updated by the interface.
As an example, for exporting and importing attributes via the MQTT protocol, the VILLASnode interfaces can be configured as follows:</p><p>Using C++:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// JSON configuration adhering to the VILLASnode documentation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>string</span> <span style=color:#000>mqttConfig</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>R</span><span style=color:#4e9a06>&#34;STRING({</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;type&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;mqtt&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;format&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;json&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;host&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;mqtt&#34;</span><span style=color:#000;font-weight:700>,</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;in&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;subscribe&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;/mqtt-dpsim&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>},</span>
</span></span><span style=display:flex><span>    <span style=color:#4e9a06>&#34;out&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>        <span style=color:#4e9a06>&#34;publish&#34;</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#4e9a06>&#34;/dpsim-mqtt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#000;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>})</span><span style=color:#000>STRING</span><span style=color:#4e9a06>&#34;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Creating a new InterfaceVillas object
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>shared_ptr</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>InterfaceVillasQueued</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>intf</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>make_shared</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>InterfaceVillasQueued</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>mqttConfig</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Configuring the InterfaceVillas to import and export attributes
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>intf</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>importAttribute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>evs</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>mVoltageRef</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>true</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>true</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>intf</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>exportAttribute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r12</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>mIntfCurrent</span><span style=color:#ce5c00;font-weight:700>-&gt;</span><span style=color:#000>deriveCoeff</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Complex</span><span style=color:#ce5c00;font-weight:700>&gt;</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>),</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87>true</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;v_load&#34;</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>Using Python:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8f5902;font-style:italic># JSON configuration adhering to the VILLASnode documentation</span>
</span></span><span style=display:flex><span><span style=color:#000>mqtt_config</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#39;&#39;&#39;{
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        &#34;type&#34;: &#34;mqtt&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        &#34;format&#34;: &#34;json&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        &#34;host&#34;: &#34;mqtt&#34;,
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        &#34;in&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;subscribe&#34;: &#34;/mqtt-dpsim&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        },
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        &#34;out&#34;: {
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>            &#34;publish&#34;: &#34;/dpsim-mqtt&#34;
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>        }
</span></span></span><span style=display:flex><span><span style=color:#4e9a06>}&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Creating a new InterfaceVillas object</span>
</span></span><span style=display:flex><span><span style=color:#000>intf</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>dpsimpyvillas</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>InterfaceVillas</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>name</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#39;dpsim-mqtt&#39;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>config</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#000>mqtt_config</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic># Configuring the InterfaceVillas to import and export attributes</span>
</span></span><span style=display:flex><span><span style=color:#000>intf</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>import_attribute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>evs</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>attr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;V_ref&#39;</span><span style=color:#000;font-weight:700>),</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>True</span><span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span><span style=color:#000>intf</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>export_attribute</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>r12</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>attr</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#39;i_intf&#39;</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>derive_coeff</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>),</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><h1 id=adding-an-interface-to-the-simulation>Adding an Interface to the Simulation</h1><p>After a new interface has been created and configured, it can be added to a simulation using the <code>Simulation::addInterface</code> method:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Create and configure simulation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>RealTimeSimulation</span> <span style=color:#000>sim</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>simName</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>sim</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setSystem</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>sys</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>sim</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setTimeStep</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>timeStep</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#000>sim</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>setFinalTime</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>10.0</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Create and configure interface
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>auto</span> <span style=color:#000>intf</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic>// Add interface to simulation
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>sim</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>addInterface</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>intf</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p>This method will add two new <a href=https://sogno-platform.github.io/dpsim/docs/overview/scheduling/>Tasks</a> to the simulation. The interface&rsquo;s <code>PreStep</code> task is set to modify all attributes that are imported from the environment and is therefore scheduled to execute before any other simulation tasks that depend on these attributes.
The interface&rsquo;s <code>PostStep</code> task is set to depend on all attributes that are exported to the environment and is therefore scheduled to execute after any other simulation tasks that might modify these attributes. To prevent the scheduler from just dropping the <code>PostStep</code> task since it does not modify any attributes and is therefore not seen as relevant to the simulation, the task is set to modify the <code>Scheduler::external</code> attribute.
Note that the execution of these tasks might not necessarily coincide with the point in time at which the values are actually written out to or read from the environment.
This is because the interface internally spawns two new threads for exchanging data with the environment and then uses a <strong>lock-free queue</strong> for communication between these reader and writer threads, and the simulation. Because of this, time-intensive import or export operations will not block
the main simulation thread unless this is explicitly configured in the interface&rsquo;s <code>importAttribute</code> and <code>exportAttribute</code> methods.</p><h1 id=synchronizing-the-simulation-with-the-environment>Synchronizing the Simulation with the Environment</h1><p>To allow for synchronizing the DPsim simulation with external services, the <code>Interface</code> class provides some additional configuration options in the <code>importAttribute</code> and <code>exportAttribute</code> methods. For imports, setting the <code>blockOnRead</code> parameter will completely halt the simulation at the start of
every time step until a new value for this attribute was read from the environment. Additionally, the <code>syncOnSimulationStart</code> parameter can be set for every
import to indicate that this attribute is used to synchronize the start of the simulation. When a simulation contains any interfaces importing attributes
which have <code>syncOnSimulationStart</code> set, the <code>Simulation::sync</code> will be called before the first time step. This method will:</p><ul><li>write out all attributes configured for export to the environment</li><li>block until all attributes with <code>syncOnSimulationStart</code> set have been read from the environment at least once</li><li>write out all exported attributes again</li></ul><p>Note that this setting operates independently of the <code>blockOnRead</code> flag. This means that with both flags set, the simulation will block again after the synchronization at the start of the first time step until another value is received for the attribute in question.</p><div class="text-muted mt-5 pt-3 border-top">Last modified 19.05.2025: <a href=https://github.com/sogno-platform/dpsim/commit/3136b5a477415979041576120b0f27c17050a6f4>pybind: Errors when compiling with clang (#334) (3136b5a)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://slack.lfenergy.org/ aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="GitHub Discussions" aria-label="GitHub Discussions"><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim/discussions aria-label="GitHub Discussions"><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="RWTH GitLab" aria-label="RWTH GitLab"><a class=text-white target=_blank rel=noopener href=https://git.rwth-aachen.de/acs/public/simulation/dpsim/dpsim aria-label="RWTH GitLab"><i class="fab fa-gitlab"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The DPsim Authors All Rights Reserved</small></div></div></div></footer></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ==" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\]"}]})'></script><script src=/dpsim/js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" crossorigin=anonymous></script>
<script src=/dpsim/js/tabpane-persist.js></script></body></html>