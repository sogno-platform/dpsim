<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.108.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/dpsim/favicons/favicon.ico><link rel=apple-touch-icon href=/dpsim/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/dpsim/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/dpsim/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/dpsim/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/dpsim/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/dpsim/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/dpsim/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/dpsim/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/dpsim/favicons/android-192x192.png sizes=192x192><title>Interfacing with the MNA Solver | DPsim</title><meta name=description content="The various solver classes based on MNASolver are used to perform Nodal Analysis during a DPsim simulation. For components to be able to influence the input variables of the MNA, they have to implement certain methods defined in the MNAInterface interface class. While it is possible to individually implement MNAInterface for every component, the behavior of many components can be unified in a common base class. This base class is called MNASimPowerComp&amp;lt;T&amp;gt;."><meta property="og:title" content="Interfacing with the MNA Solver"><meta property="og:description" content="The various solver classes based on MNASolver are used to perform Nodal Analysis during a DPsim simulation. For components to be able to influence the input variables of the MNA, they have to implement certain methods defined in the MNAInterface interface class. While it is possible to individually implement MNAInterface for every component, the behavior of many components can be unified in a common base class. This base class is called MNASimPowerComp<T>."><meta property="og:type" content="article"><meta property="og:url" content="https://sogno-platform.github.io/dpsim/docs/overview/mnainterface/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-12-19T00:00:00+00:00"><meta property="article:modified_time" content="2025-05-19T09:13:55+02:00"><meta property="og:site_name" content="DPsim"><meta itemprop=name content="Interfacing with the MNA Solver"><meta itemprop=description content="The various solver classes based on MNASolver are used to perform Nodal Analysis during a DPsim simulation. For components to be able to influence the input variables of the MNA, they have to implement certain methods defined in the MNAInterface interface class. While it is possible to individually implement MNAInterface for every component, the behavior of many components can be unified in a common base class. This base class is called MNASimPowerComp<T>."><meta itemprop=datePublished content="2022-12-19T00:00:00+00:00"><meta itemprop=dateModified content="2025-05-19T09:13:55+02:00"><meta itemprop=wordCount content="476"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Interfacing with the MNA Solver"><meta name=twitter:description content="The various solver classes based on MNASolver are used to perform Nodal Analysis during a DPsim simulation. For components to be able to influence the input variables of the MNA, they have to implement certain methods defined in the MNAInterface interface class. While it is possible to individually implement MNAInterface for every component, the behavior of many components can be unified in a common base class. This base class is called MNASimPowerComp<T>."><link rel=preload href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css as=style><link href=/dpsim/scss/main.min.73bc65c1e18bb0cbd02b071f40b73b018bed23b1835e915c0f4f73a772a6713b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/dpsim/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>DPsim</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/dpsim/docs/><span class=active>Documentation</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/dpsim/offline-search-index.31f486977b610cddaaea15472137aabf.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocs-li><a href=/dpsim/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-dpsimdocs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-dpsimdocsoverview-li><a href=/dpsim/docs/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsoverview><span>Overview</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewarchitecture-li><a href=/dpsim/docs/overview/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewarchitecture><span>Architecture</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewattributes-li><a href=/dpsim/docs/overview/attributes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewattributes><span>Attributes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewscheduling-li><a href=/dpsim/docs/overview/scheduling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewscheduling><span>Scheduling</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewinterfaces-li><a href=/dpsim/docs/overview/interfaces/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewinterfaces><span>Interfaces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-dpsimdocsoverviewmnainterface-li><a href=/dpsim/docs/overview/mnainterface/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewmnainterface><span class=td-sidebar-nav-active-item>Interfacing with the MNA Solver</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsoverviewsubcomponents-li><a href=/dpsim/docs/overview/subcomponents/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsoverviewsubcomponents><span>Subcomponent Handling</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsgetting-started-li><a href=/dpsim/docs/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsgetting-started><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedreal-time-li><a href=/dpsim/docs/getting-started/real-time/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedreal-time><span>Real-Time</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedbuild-li><a href=/dpsim/docs/getting-started/build/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedbuild><span>Build</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsgetting-startedinstall-li><a href=/dpsim/docs/getting-started/install/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsgetting-startedinstall><span>Install</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsconcepts-li><a href=/dpsim/docs/concepts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsconcepts><span>Concepts</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsdyn-phasors-li><a href=/dpsim/docs/concepts/dyn-phasors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsdyn-phasors><span>Dynamic Phasors</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptsnodal-analysis-li><a href=/dpsim/docs/concepts/nodal-analysis/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptsnodal-analysis><span>Nodal Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsconceptspowerflow-li><a href=/dpsim/docs/concepts/powerflow/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsconceptspowerflow><span>Powerflow</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsdevelopment-li><a href=/dpsim/docs/development/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsdevelopment><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentdebugging-li><a href=/dpsim/docs/development/debugging/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentdebugging><span>Debugging</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsdevelopmentguidelines-li><a href=/dpsim/docs/development/guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsdevelopmentguidelines><span>Guidelines</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocsmodels-li><a href=/dpsim/docs/models/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsmodels><span>Models</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelstransformer-li><a href=/dpsim/docs/models/transformer/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelstransformer><span>Transformer</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsbranches-li><a href=/dpsim/docs/models/branches/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsbranches><span>Branches</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsinduction-machine-li><a href=/dpsim/docs/models/induction-machine/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsinduction-machine><span>Induction Machine</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelsrlc-elements-li><a href=/dpsim/docs/models/rlc-elements/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelsrlc-elements><span>RLC-Elements</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelssynchronous-generator-li><a href=/dpsim/docs/models/synchronous-generator/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelssynchronous-generator><span>Synchronous Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsmodelspower-electronics-li><a href=/dpsim/docs/models/power-electronics/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsmodelspower-electronics><span>VS-Inverter</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-dpsimdocstasks-li><a href=/dpsim/docs/tasks/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocstasks><span>Core Tasks</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstasksadd-model-li><a href=/dpsim/docs/tasks/add-model/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstasksadd-model><span>Add New Model</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocstaskscreate-simulation-li><a href=/dpsim/docs/tasks/create-simulation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocstaskscreate-simulation><span>Create New Simulation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsexamples-li><a href=/dpsim/docs/examples/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-dpsimdocsexamples><span>Examples</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsroadmap-li><a href=/dpsim/docs/roadmap/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsroadmap><span>Roadmap</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocsreference-li><a href=/dpsim/docs/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocsreference><span>Reference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-dpsimdocscontribution-guidelines-li><a href=/dpsim/docs/contribution-guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-dpsimdocscontribution-guidelines><span>Contribution Guidelines</span></a></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/sogno-platform/dpsim/tree/master/content/en/docs/Overview/mnainterface.md class=td-page-meta--view target=_blank rel=noopener><i class="fa-solid fa-file-lines fa-fw"></i> View page source</a>
<a href=https://github.com/sogno-platform/dpsim/edit/master/content/en/docs/Overview/mnainterface.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Edit this page</a>
<a href="https://github.com/sogno-platform/dpsim/new/master/content/en/docs/Overview/mnainterface.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa-solid fa-pen-to-square fa-fw"></i> Create child page</a>
<a href="https://github.com/sogno-platform/dpsim/issues/new?title=Interfacing%20with%20the%20MNA%20Solver" class=td-page-meta--issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/sogno-platform/dpsim/issues/new class=td-page-meta--project-issue target=_blank rel=noopener><i class="fa-solid fa-list-check fa-fw"></i> Create project issue</a>
<a id=print href=https://sogno-platform.github.io/dpsim/docs/overview/_print/><i class="fa-solid fa-print fa-fw"></i> Print entire section</a></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/>Documentation</a></li><li class=breadcrumb-item><a href=https://sogno-platform.github.io/dpsim/docs/overview/>Overview</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://sogno-platform.github.io/dpsim/docs/overview/mnainterface/ aria-disabled=true class="btn-link disabled">Interfacing with the MNA Solver</a></li></ol></nav><div class=td-content><h1>Interfacing with the MNA Solver</h1><header class=article-meta></header><p>The various solver classes based on <code>MNASolver</code> are used to perform <a href=https://sogno-platform.github.io/dpsim/docs/concepts/nodal-analysis/>Nodal Analysis</a> during a DPsim simulation. For components to be able to influence the input variables of the MNA, they have to implement certain methods defined in the <code>MNAInterface</code> interface class. While it is possible to individually implement <code>MNAInterface</code> for every
component, the behavior of many components can be unified in a common base class. This base class is called <code>MNASimPowerComp&lt;T></code>.
Currently, it is the only class which directly implements <code>MNAInterface</code> and in turn all MNA components inherit from this class.
Much like the <code>CompositePowerComp</code> class for <a href=https://sogno-platform.github.io/dpsim/docs/overview/subcomponents/>Composite Components</a>, the <code>MNASimPowerComp</code> class
provides some common behavior for all MNA components, e.g. the creation and registration of the <code>MNAPreStep</code> and <code>MNAPostStep</code> tasks.
Additionally, <code>MNASimPowerComp</code> provides a set of virtual methods prefixed <code>mnaComp...</code> which can be implemented by the child component classes to provide their own MNA behavior. These methods are:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompInitialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Real</span> <span style=color:#000>omega</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Real</span> <span style=color:#000>timeStep</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Attribute</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&gt;::</span><span style=color:#000>Ptr</span> <span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompApplySystemMatrixStamp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>SparseMatrixRow</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>systemMatrix</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompApplyRightSideVectorStamp</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>rightVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompUpdateVoltage</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompUpdateCurrent</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>const</span> <span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompPreStep</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Real</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Int</span> <span style=color:#000>timeStepCount</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompPostStep</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Real</span> <span style=color:#000>time</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Int</span> <span style=color:#000>timeStepCount</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Attribute</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&gt;::</span><span style=color:#000>Ptr</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompAddPreStepDependencies</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>prevStepDependencies</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>attributeDependencies</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>modifiedAttributes</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompAddPostStepDependencies</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>prevStepDependencies</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>attributeDependencies</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>AttributeBase</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>List</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>modifiedAttributes</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Attribute</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&gt;::</span><span style=color:#000>Ptr</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompInitializeHarm</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Real</span> <span style=color:#000>omega</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Real</span> <span style=color:#000>timeStep</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>std</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>vector</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Attribute</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&gt;::</span><span style=color:#000>Ptr</span><span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompApplySystemMatrixStampHarm</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>SparseMatrixRow</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>systemMatrix</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Int</span> <span style=color:#000>freqIdx</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompApplyRightSideVectorStampHarm</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>sourceVector</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span><span style=color:#204a87;font-weight:700>virtual</span> <span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>mnaCompApplyRightSideVectorStampHarm</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&amp;</span> <span style=color:#000>sourceVector</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Int</span> <span style=color:#000>freqIdx</span><span style=color:#000;font-weight:700>);</span>
</span></span></code></pre></div><p><code>MNASimPowerComp</code> provides empty default implementations for all of these methods, so component classes are not forced to implement any of them.</p><h1 id=controlling-common-base-class-behavior>Controlling Common Base Class Behavior</h1><p>Child component classes can control the behavior of the base class through the constructor arguments of <code>MNASimPowerComp</code>.
The two boolean variables <code>hasPreStep</code> and <code>hasPostStep</code> can be used to control whether the <code>MNAPreStep</code> and <code>MNAPostStep</code> tasks will be created and registered.
If these tasks are created, the <code>mnaCompPreStep</code> / <code>mnaCompPostStep</code> and <code>mnaCompAddPreStepDependencies</code> / <code>mnaCompAddPostStepDependencies</code> methods will be called during the component&rsquo;s lifecycle.
If the tasks are not created, these methods are superfluous and should not be implemented in the child class.</p><p>Currently, the <code>MNASimPowerComp</code> base class only exhibits additional behavior over the <code>mnaComp...</code> methods in the <code>mnaInitialize</code> method. In this method, the list of MNA tasks is cleared, and the new tasks are added according to the <code>hasPreStep</code> and <code>hasPostStep</code> parameters. Additionally, the right vector attribute <code>mRightVector</code> required by <code>MNAInterface</code> is set to a zero-vector with its length equal to that of the system <code>leftVector</code>.
If this behavior is not desired, e.g. for resistors which have no influence on the system right vector, the right vector can be re-set to have zero size in the <code>mnaCompInitialize</code> method:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#204a87;font-weight:700>void</span> <span style=color:#000>DP</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Ph1</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Resistor</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>mnaCompInitialize</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Real</span> <span style=color:#000>omega</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Real</span> <span style=color:#000>timeStep</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>Attribute</span><span style=color:#ce5c00;font-weight:700>&lt;</span><span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>&gt;::</span><span style=color:#000>Ptr</span> <span style=color:#000>leftVector</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
</span></span><span style=display:flex><span>  <span style=color:#000>updateMatrixNodeIndices</span><span style=color:#000;font-weight:700>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#ce5c00;font-weight:700>**</span><span style=color:#000>mRightVector</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>Matrix</span><span style=color:#ce5c00;font-weight:700>::</span><span style=color:#000>Zero</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>);</span>
</span></span><span style=display:flex><span>  <span style=color:#8f5902;font-style:italic>//...
</span></span></span><span style=display:flex><span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>For all other MNA methods, the <code>MNASimPowerComp</code> base class will just call the associated <code>mnaComp...</code> method. For more details, take a look at the implementations in <code>MNASimPowerComp.cpp</code>.</p><div class="text-muted mt-5 pt-3 border-top">Last modified 19.05.2025: <a href=https://github.com/sogno-platform/dpsim/commit/3136b5a477415979041576120b0f27c17050a6f4>pybind: Errors when compiling with clang (#334) (3136b5a)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel=noopener href=https://slack.lfenergy.org/ aria-label=Slack><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="GitHub Discussions" aria-label="GitHub Discussions"><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim/discussions aria-label="GitHub Discussions"><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/sogno-platform/dpsim aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="RWTH GitLab" aria-label="RWTH GitLab"><a class=text-white target=_blank rel=noopener href=https://git.rwth-aachen.de/acs/public/simulation/dpsim/dpsim aria-label="RWTH GitLab"><i class="fab fa-gitlab"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2025 The DPsim Authors All Rights Reserved</small></div></div></div></footer></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css integrity="sha512-6VMVcy7XQNyarhVuiL50FzpgCFKsyTd6YO93aaQEyET+BNaWvj0IgKR86Bf6+AmWczxAcSnL+JGjo+iStgO1gQ==" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js integrity="sha512-b9IKj4LCNrtCPBhceRcoYOHWW/S2q9fpl7iAJlyxYpykRj1SKM7FE9+E0NEnJ8g8ni47LBr2GuX9qzg/xeuwzQ==" crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\]"}]})'></script><script src=/dpsim/js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" crossorigin=anonymous></script>
<script src=/dpsim/js/tabpane-persist.js></script></body></html>